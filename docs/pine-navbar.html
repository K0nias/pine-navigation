<!DOCTYPE html>

<html>
<head>
  <title>PineJS: Responsive navigation widget</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="pine-navbar.html">
                pine-navbar.js
              </a>
            
              
              <a class="source" href="pine-submenu.html">
                pine-submenu.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="pinejs-responsive-navigation-widget">PineJS: Responsive navigation widget</h1>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>PineJS is very simple and flexible responsive navigation. Its purpose is
to simplify implementation of the navigation in your projects.</p>
<h2 id="basic-usage">BASIC USAGE</h2>
<pre><code class="lang-javascript">  $(&#39;[role=navigation]&#39;).pine()</code></pre>
<h2 id="configuration">CONFIGURATION</h2>
<pre><code class="lang-javascript">  $(&#39;[role=navigation]&#39;).pine({
    transitionMobile:   &#39;fx-toggle&#39;,
    transitionDesktop:  &#39;fx-hover-fade&#39;
  })</code></pre>
<h3 id="defaults">Defaults</h3>
<pre><code class="lang-javascript">  Navbar.defaults = {
    jsBreakpoint:       &#39;600px&#39;,
    transitionMobile:   &#39;fx-toggle&#39;,
    transitionDesktop:  &#39;fx-hover-fade&#39;
  }</code></pre>
<p>Available transitions out of the box:</p>
<ol>
<li>Mobile<ul>
<li><strong>Toggle</strong> - simple show and hide of the child list</li>
<li><strong>Right to Left</strong> - each level of navigation slides in from the right</li>
<li><strong>Left to Right</strong> - inverted direction, for Arabic and other languages</li>
</ul>
</li>
<li>Desktop<ul>
<li><strong>Toggle</strong> - menus are toggled by click</li>
<li><strong>Hover</strong> - menus are toggled on hover</li>
<li><strong>Hover with fade in/out</strong> - extension to &#39;hover&#39; transition, animation is added</li>
</ul>
</li>
</ol>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/**
  Global Pine object
**/</span>
<span class="keyword">var</span> Pine = window.Pine || {}

<span class="comment">/**
  Navbar module provides base for the responsive navigation widget.
**/</span>
Pine.Navbar = (<span class="function"><span class="keyword">function</span> <span class="params">($, window, undefined)</span> {</span> <span class="string">"use strict"</span>;

  <span class="keyword">var</span> version = <span class="string">'0.0.1'</span>,

  Navbar = {};

  <span class="comment">/**
    Stores the state of the current view. Either true for large displays or false for small ones.
  **/</span>
  Navbar.isDesktop = <span class="literal">null</span>;

  <span class="comment">/**
    Root element.
  **/</span>
  Navbar.element = <span class="literal">null</span>;

  <span class="comment">/**
    Default configuration for the module.
  **/</span>
  Navbar.DEFAULTS = {
    jsBreakpoint:       <span class="string">'600px'</span>,
    transitionDesktop:  <span class="string">'fx-hover'</span>,
    transitionMobile:   <span class="string">'fx-toggle'</span>
  };

  Navbar.NAVBAR_TOGGLE =  <span class="string">'[data-pine=toggle]'</span>;
  Navbar.SUBMENU =        <span class="string">'.has-submenu'</span>;

  <span class="comment">/**
    Navigation options which override defaults
  **/</span>
  Navbar.options = <span class="literal">null</span>;

  <span class="comment">/**
    List of all available transitions. Transitions are loaded as plugins via registerTransition().
  **/</span>
  Navbar.transitions = {};

  <span class="comment">/**
    Applied transition, which depends on the current view (dektop or mobile)
  **/</span>
  Navbar.activeTransition = {};

  <span class="comment">/**
    Initialize all properties and sets up event listeners
  **/</span>
  Navbar.init = <span class="function"><span class="keyword">function</span><span class="params">(element, options)</span> {</span>
    <span class="keyword">this</span>.options = $.extend({}, <span class="keyword">this</span>.DEFAULTS, options)
    <span class="keyword">this</span>.element = $(element)

    <span class="comment">/* Initialize view and set active transtition */</span>
    <span class="keyword">this</span>.isDesktop = window.matchMedia(<span class="string">'(min-width: '</span> + <span class="keyword">this</span>.options.jsBreakpoint + <span class="string">')'</span>).matches
    <span class="keyword">this</span>.isDesktop ? <span class="keyword">this</span>.setActiveTransition(<span class="keyword">this</span>.options.transitionDesktop) : <span class="keyword">this</span>.setActiveTransition(<span class="keyword">this</span>.options.transitionMobile)

    <span class="comment">/* Initialize submenus */</span>
    <span class="keyword">this</span>.element.find(<span class="string">'li'</span>).has(<span class="string">'ul'</span>).addClass(<span class="string">'has-submenu'</span>)
    <span class="keyword">this</span>.element.find(<span class="string">'a'</span>).on(<span class="string">'focus.pine'</span>, <span class="keyword">this</span>.focus)

    <span class="comment">/* Default behavior, submenu is triggered on click */</span>
    $(document).on(<span class="string">'click.pine.submenu'</span>, <span class="keyword">this</span>.SUBMENU + <span class="string">' &gt; a'</span>, <span class="keyword">this</span>, Pine.Submenu.toggle)
    $(document).on(<span class="string">'click.pine.trigger'</span>, <span class="keyword">this</span>.NAVBAR_TOGGLE, <span class="keyword">this</span>, Pine.Navbar.toggle)

    <span class="comment">/* Setup API with all listeners */</span>
    $(window).on(<span class="string">'load resize'</span>, $.proxy(<span class="keyword">this</span>.api, <span class="keyword">this</span>))
  };

  <span class="comment">/**
    Navigation module API method handles switch between views.
  **/</span>
  Navbar.api = <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> {</span>
    <span class="keyword">var</span> media = <span class="keyword">this</span>.checkMedia(e)

    <span class="comment">/* Check if there is actual change of media */</span>
    <span class="keyword">if</span>(media === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>

    <span class="comment">/* Perform transition when leaving view */</span>
    <span class="keyword">if</span>(<span class="keyword">this</span>.activeTransition &amp;&amp; <span class="keyword">typeof</span> <span class="keyword">this</span>.activeTransition.onSwitch === <span class="string">'function'</span>) {
      <span class="keyword">this</span>.activeTransition.onSwitch.call(<span class="keyword">this</span>, <span class="literal">false</span>)
    }

    <span class="comment">/* Perform all operations to switch between views */</span>
    <span class="keyword">this</span>.switchView(media)

    <span class="comment">/* Perform transition after entering view */</span>
    <span class="keyword">if</span>(<span class="keyword">this</span>.activeTransition &amp;&amp; <span class="keyword">typeof</span> <span class="keyword">this</span>.activeTransition.onSwitch === <span class="string">'function'</span>) {
      <span class="keyword">this</span>.activeTransition.onSwitch.call(<span class="keyword">this</span>, <span class="literal">true</span>)
    }
  };

  <span class="comment">/**
    Checks current view if it satisfies switch condition. If no switch occurs, it returns null.
  **/</span>
  Navbar.checkMedia = <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> {</span>
    <span class="keyword">var</span> condition = window.matchMedia(<span class="string">'(min-width: '</span> + <span class="keyword">this</span>.options.jsBreakpoint + <span class="string">')'</span>).matches
    <span class="keyword">var</span> isLoad = e.type &amp;&amp; (e.type == <span class="string">'load'</span>)

    <span class="comment">/* Check first load or switch beetween views (mobile XOR desktop), it sets isDesktop value only when it is needed */</span>
    <span class="keyword">if</span> (isLoad || (( <span class="keyword">this</span>.isDesktop || condition ) &amp;&amp; !( <span class="keyword">this</span>.isDesktop &amp;&amp; condition ))) {
      <span class="keyword">return</span> <span class="keyword">this</span>.isDesktop = condition
    }

    <span class="keyword">return</span> <span class="literal">null</span>
  };


  <span class="comment">/**
    Switches active transition when leaving one view and entering another.
  **/</span>
  Navbar.switchView = <span class="function"><span class="keyword">function</span> <span class="params">(isDesktop)</span> {</span>
    <span class="keyword">var</span> t = <span class="keyword">this</span>.getTransitionName(isDesktop)

    <span class="keyword">this</span>.element
      .removeClass(<span class="keyword">this</span>.getTransitionName(!isDesktop))
      .addClass(t)

    <span class="keyword">this</span>.setActiveTransition(t)
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>TODO: abstrahovat eventy, nemusi to byt mousenter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="comment">/**
    Event handler which is fired after keyboard input (tab).
  **/</span>
  Navbar.focus = <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> {</span>
    <span class="comment">/* Check if the focused element is part of some Submenu */</span>
    <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>)
    <span class="keyword">var</span> $parent  = $<span class="keyword">this</span>.parent()

    <span class="keyword">if</span> ($parent.hasClass(<span class="string">'has-submenu'</span>) &amp;&amp; !$parent.hasClass(<span class="string">'is-open'</span>)) {
      $<span class="keyword">this</span>.trigger($.Event(<span class="string">'mouseenter'</span>))
    }

    <span class="keyword">var</span> openedMenus = $(<span class="string">'.is-open'</span>)

    <span class="keyword">if</span>(openedMenus.length == <span class="number">0</span>) <span class="keyword">return</span>

    openedMenus.filter(<span class="function"><span class="keyword">function</span><span class="params">(i)</span>{</span>
      <span class="keyword">return</span> $(<span class="keyword">this</span>).find($<span class="keyword">this</span>).length === <span class="number">0</span>
    }).removeClass(<span class="string">'is-open'</span>)
  };

  <span class="comment">/**
    Setter for transitions. New transition is added to transitions collection.
  **/</span>
  Navbar.setActiveTransition = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
    <span class="keyword">this</span>.activeTransition = <span class="keyword">this</span>.transitions[name] || <span class="literal">false</span>
  };

  <span class="comment">/**
    Getter for transition.
  **/</span>
  Navbar.getTransitionName = <span class="function"><span class="keyword">function</span> <span class="params">(isDesktop)</span> {</span>
    <span class="keyword">return</span> isDesktop ? <span class="keyword">this</span>.options.transitionDesktop : <span class="keyword">this</span>.options.transitionMobile
  };

  <span class="comment">/**
    Adds new transition to the collection.
  **/</span>
  Navbar.registerTransition = <span class="function"><span class="keyword">function</span> <span class="params">(name, obj)</span> {</span>
    <span class="keyword">this</span>.transitions[name] = obj
  };

  <span class="comment">/**
    Toggles menu in mobile view
  **/</span>
  Navbar.toggle = <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> {</span>
    e.preventDefault();

    $(<span class="keyword">this</span>).toggleClass(<span class="string">'is-active'</span>)
    $(document).find($(<span class="keyword">this</span>).attr(<span class="string">'href'</span>)).toggleClass(<span class="string">'is-visible'</span>)
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="navbar-plugin-definition">NAVBAR PLUGIN DEFINITION</h2>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> old = $.fn.pine

  $.fn.pine = <span class="function"><span class="keyword">function</span> <span class="params">(option)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">var</span> $<span class="keyword">this</span>   = $(<span class="keyword">this</span>)
      <span class="keyword">var</span> data    = $<span class="keyword">this</span>.data(<span class="string">'pine'</span>)
      <span class="keyword">var</span> options = $.extend({}, $<span class="keyword">this</span>.data(), <span class="keyword">typeof</span> option == <span class="string">'object'</span> &amp;&amp; option)

      <span class="keyword">if</span> (!data) $<span class="keyword">this</span>.data(<span class="string">'pine'</span>, (data = Navbar.init(<span class="keyword">this</span>, options)))
      <span class="comment">/*  if (typeof option == 'string') data[option]() */</span>
    })
  }

  $.fn.pine.Module = Navbar</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2 id="navbar-no-conflict">NAVBAR NO CONFLICT</h2>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  $.fn.pine.noConflict = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    $.fn.pine = old
    <span class="keyword">return</span> <span class="keyword">this</span>
  }

  <span class="keyword">return</span> Navbar;

})(jQuery, window);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
